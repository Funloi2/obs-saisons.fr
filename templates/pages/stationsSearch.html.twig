{% extends 'base.html.twig' %}

{% block main_content %}
	{% include 'layout/header.html.twig' with ({
		'title': 'Stations d’observation',
		'subtitle': 'Les <strong>stations d’observation</strong> sont les zones où se trouvent les plantes ou animaux que vous souhaitez observer. <br>Vous pouvez rejoindre une station existante ou en créer une nouvelle.'
	}) %}
	{% include 'components/actionbar.html.twig' with {
		actionbar: {
			'classes': 'search',
			'components': [
				{
					'name': 'side-block',
					'data': {
						'type': 'search',
						'text': 'Nom, ville, code postal...'
					}
				},
				{
					'name': 'stations-tabs-holder'
				}
			]
		},
		search: search
	} %}

		<h3 class="search-results">Résultats de votre recherche</h3>

		{% if stationsArray is empty %}
			<p class="search-results">Aucun résultat pour <strong>"{{ search }}"</strong>.</p>

		{% else %}
			<p class="search-results">
				Votre recherche correspond aux stations suivantes,<br>
				les titres correspondent aux critères de recherche :
			</p>

			{% for searchKey, stations in stationsArray %}
				<h4 class="search-results">{{ searchKey|capitalize }} :</h4>
				<div class="cards-grid-container">

					{% set cards = setStationCards(stations) %}
					{%  for card in cards %}
						{% include 'components/cards/station-cards.html.twig' with {
							station: card.station,
							observations: card.observations,
							contributorsCount: card.contributorsCount

						} %}
					{% endfor %}
				</div>
			{% endfor %}
		{% endif %}
		{%  if 3 > search|length and not (search matches '/^\\d+$/')%}
			<p class="search-results ods-form-warning">
				Lorsque vous utilisez moins de 3 caractères la recherche est limitée aux résultats exacts.<br>
				Pour plus de resultats (s'il en existe) veuillez entrer au moins 3 caractères.
			</p>
		{% endif %}

	{% include 'components/help-block.html.twig' with {
		help: {
			'text':
				'Cliquez sur une station pour accéder à la liste des observations qui y ont été faites.<br>
				Vous pourrez découvrir la liste des espèces à observer pour chaque station et ajouter vos propres observations.<br>
				<br>'
		}
	} %}

{% endblock %}
