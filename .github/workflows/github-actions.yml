name: OBS
run-name: OBS
on: [ push ]
jobs:

  Deploy-Docker-Compose:
    runs-on: [ self-hosted, linux, x64 ]
#    env:
#      DB_NAME: ${{ secrets.DB_NAME }}
#      DB_USER: ${{ secrets.DB_USER }}
#      DB_PASSWORD: ${{ secrets.DB_PASSWORD }}
#      DB_ROOT_PASSWORD: ${{ secrets.DB_ROOT_PASSWORD }}
#      APP_ENV: ${{ secrets.APP_ENV }}
#      APP_SECRET: ${{ secrets.APP_SECRET }}
#      DEFAULT_URI: ${{ secrets.DEFAULT_URI }}
    steps:
      - name: Checkout
        uses: actions/checkout@v3
        with:
          repository: 'Funloi2/obs-saisons.fr'
          ref: 'docker-test'
      - name: Docker Compose Action
        uses: hoverkraft-tech/compose-action@v2.0.0
        with:
          compose-file: "./docker-compose.yml" # Path to your docker-compose file
          up-flags: "-d" # Flags to pass to the `docker-compose up` command
#          project-name: obs
#          services: web
          env:
            DB_NAME=${{ secrets.DB_NAME }}
            DB_USER=${{ secrets.DB_USER }}
            DB_PASSWORD=${{ secrets.DB_PASSWORD }}
            APP_ENV=${{ secrets.APP_ENV }}
            APP_SECRET=${{ secrets.APP_SECRET }}
            DEFAULT_URI=${{ secrets.DEFAULT_URI }}

#      - name: Build
#        run: docker-compose build
#      - name: Up file
#        run: docker-compose up -d

